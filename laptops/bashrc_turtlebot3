# Bash profile with ROS settings for the Turtlebot3 robot

# ROS settings for TurtleBot3 (localhost)
source /opt/ros/humble/setup.bash
source ~/tb3_ws/install/setup.bash
export TURTLEBOT3_MODEL=waffle

# Check if waffle_number file exists, if not copy laptop_number to waffle_number
if [ ! -f ~/.tuos/waffle_number ]; then
    cp /home/Shared/laptop_number ~/.tuos/waffle_number
fi

# Check the content of robot_mode file and set RDS and LHOST_ONLY variables accordingly
if [ ! -f ~/.tuos/robot_mode ]; then
    echo "robot" > ~/.tuos/robot_mode
elif grep -qi "robot" ~/.tuos/robot_mode; then
    RDS="dia-waffle$WAFFLE_NO:11811;dia-waffle$WAFFLE_NO:11888"
    LHOST_ONLY=0
    SUPER_CLIENT=TRUE
elif grep -qi "sim" ~/.tuos/robot_mode; then
    RDS=""
    LHOST_ONLY=1
    SUPER_CLIENT=FALSE
else
    RDS="dia-waffle$WAFFLE_NO:11811;dia-waffle$WAFFLE_NO:11888"
    LHOST_ONLY=0
    SUPER_CLIENT=TRUE
fi

# Export the updated variables for ROS settings
export ROS_DISCOVERY_SERVER=$RDS
export ROS_LOCALHOST_ONLY=$LHOST_ONLY
export ROS_HOSTNAME=$(hostname)
export ROS_SUPER_CLIENT=$SUPER_CLIENT
