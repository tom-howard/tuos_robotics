#!/usr/bin/env bash

# Diamond Tools for TB3 Waffles
# locate in /usr/local/bin/

if [[ $# -eq 0 ]]; then
  echo "No input command provided. Exiting."
  exit 1
else
  COMMAND=$1
fi

sudo_check() {
  if [[ ! $(sudo echo 0) ]]; then
    echo "Failed sudo check. Exiting."
    exit
  fi
}

getx() {
  SCRIPT=$1
  LOCAL_SCRIPT="$SCRIPT-$(date +'%Y%m%d%H%M%S')"
  echo "[INFO]: Obtaining '$SCRIPT.sh' script from GitHub..."
  cd $HOME/.tuos/
  wget -O $LOCAL_SCRIPT.sh https://raw.githubusercontent.com/tom-howard/tuos_robotics/humble/turtlebot3/diamond_tools/$SCRIPT.sh
  echo "[INFO]: Executing script..."
  chmod +x $LOCAL_SCRIPT.sh && ./$LOCAL_SCRIPT.sh
}

case $COMMAND in 
  setup)
    sudo_check
    SCRIPT=tb3_setup
    getx $SCRIPT
    ;;
  update)
    sudo_check
    getx update_tools
    ;;
  workspace)
    sudo_check
    getx ros_ws
    ;;
  *)
    echo "Not a valid input (use 'setup', 'update' or 'workspace')."
    exit 1
    ;;
esac
